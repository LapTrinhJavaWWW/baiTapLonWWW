<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang chủ-admin</title>
    <!-- boostrap css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- file css -->
    <link rel="stylesheet" href="/css/homeAdmin.css">
    <!-- icon awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
</head>

<body>
    
    <div th:include="admin/header.html"></div>
    <div class="container mb-5">
        <div class="d-flex align-items-center text-center">        
            <div class="dropdown">
                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
                  <span th:text="${usernames}"></span>
                </a>
              
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                  <li><a class="dropdown-item" href="/auth/logout">Đăng xuất</a></li>
                </ul>
              </div>
        </div>
    </div>
    <div class="container shadow p-3 mb-5 bg-body rounded">
        <div class="row">
            <div class="col-md-12">
                <h1>Add product</h1>
                <form th:action="@{/admin/product/save}" method="POST" class="row">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">Type</th>
                                <th scope="col">Name</th>
                                <th scope="col">Slug</th>
                                <th scope="col">Price</th>
                                <th scope="col">Image</th>
                                <th scope="col">Sceen</th>
                                <th scope="col">Chip</th>
                                <th scope="col">Ram</th>
                                <th scope="col">Rom</th>
                                <th scope="col">BestSeller</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <select class="form-select" style="max-width:9rem;height:2.5rem" name="type">
                                        <option>Đien thoai</option>
                                        <option>Tablet</option>
                                        <option>Phu kien</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="max-width:9rem;height:2.5rem" name="name">
                                </td>
                                <td>
                                    <select class="form-select" style="max-width:9rem;height:2.5rem" name="slug">
                                        <option>Apple</option>
                                        <option>Samsung</option>
                                        <option>Oppo</option>
                                        <option>Xiaomi</option>
                                        <option>Vivo</option>
                                        <option>Realme</option>
                                        <option>Asus</option>
                                        <option>Nokia</option>
                                        <option>Masstel</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="max-width:9rem;height:2.5rem" name="price">
                                </td>
                                <td>
                                    <input type="text" style="max-width:9rem;height:2.5rem" name="img">
                                </td>
                                <td>
                                    <select class="form-select" style="max-width:5rem;height:2.5rem" name="screen">
                                        <option>6.4</option>
                                        <option>6.5</option>
                                        <option>6.6</option>
                                        <option>6.7</option>
                                        <option>6.8</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="max-width:9rem;height:2.5rem" name="chip">
                                </td>
                                <td>
                                    <select class="form-select" style="max-width:5rem;height:2.5rem" name="ram">
                                        <option>2</option>
                                        <option>4</option>
                                        <option>8</option>
                                        <option>16</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="form-select" style="max-width:5rem;height:2.5rem" name="rom">
                                        <option>64</option>
                                        <option>128</option>
                                        <option>256</option>
                                        <option>512</option>
                                    </select>
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="bestSeller">
                                </td>
                                <td>
                                    <input type="submit" value="save">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
    </div>


    <div class="container shadow p-3 mb-5 bg-body rounded">
        <!-- <h1>List products</h1> -->
        <div class="row header" style="text-align:center;color:green">
            <!-- <h3>Danh sách sản phẩm</h3> -->
        </div>
        <div class="row mb-2">
            <div class="col">

            </div>
            <div class="col">
                <div class="search" style="float: right;">
                    <div class="search-icon"></div>
                    <form>
                        <div class="search-field">
                            <i class="fa fa-refresh" aria-hidden="true" id="refresh"></i>
                            <input type="text" class="search-input" placeholder="Search..." style="border-radius: 5px;"
                                name="search">
                            <input type="button" value="search" id="btnsearch"
                                style="border-radius: 4px;border: none;background-color: black;color: rgb(255, 255, 255);opacity: 0.8;">
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <table id="example" class="table table-striped table-bordered" style="width:100%" th:if="${products != 'null'}">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Price</th>
                    <th>Image</th>
                    <th>Sceen</th>
                    <th>Chip</th>
                    <th>Ram</th>
                    <th>Rom</th>
                    <th>BestSeller</th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="item : ${products}">
                    <td th:text="${item.id}" style="text-align: center;"></td>
                    <td th:text="${item.type}" style="text-align: center;"></td>
                    <td th:text="${item.name}" style="text-align: center;"></td>
                    <td th:text="${item.price}" style="text-align: center;"></td>
                    <td th:text="${item.img[0]}" style="word-wrap: normal;overflow: hidden;max-width:10rem">61</td>
                    <td th:text="${item.screen}" style="text-align: center;"></td>
                    <td th:text="${item.chip}" style="text-align: center;"></td>
                    <td th:text="${item.ram}" style="text-align: center;"></td>
                    <td th:text="${item.rom}" style="text-align: center;"></td>
                    <td th:text="${item.bestSeller}" style="text-align: center;"></td>
                    <td style="cursor: pointer;" id="dataDelete" th:value="${item.id}" data-bs-toggle="modal"
                        data-bs-target="#ModalDelete">
                        <i class="fa fa-trash" aria-hidden="true"></i>
                    </td>
                    <td style="cursor: pointer;" id="btnUpdate" data-bs-toggle="modal" data-bs-target="#ModalEdit">
                        <i class="fa fa-pencil" aria-hidden="true"></i>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <!-- Modal delete product-->
    <div class="modal fade" id="ModalDelete" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="exampleModalLabel"><strong>Cảnh báo</strong><i
                            class="fa fa-exclamation-triangle" aria-hidden="true" style="color: red;"></i></h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <i class="fa fa-frown-o" aria-hidden="true"></i><span>Bạn thật sự muốn xóa sản phẩm này!</span>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-danger btnDelete">Confirm</button>
                </div>
            </div>
        </div>
    </div>
    <!-- model edit product -->
    <div class="modal fade" id="ModalEdit" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="exampleModalLabel"><strong>Cập nhật sản phẩm</strong><i
                            class="fa fa-pencil" aria-hidden="true" style="color:rgb(252, 184, 11)"></i></h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-1">
                            <label for="typeEdit" style="font-size: 1vw;">Type:</label>
                            <select class="form-select" id="typeEdit"
                                style="max-width:9rem;height:1.9rem;font-size: 0.8vw;" name="type">
                                <option>Đien thoai</option>
                                <option>Tablet</option>
                                <option>Phu kien</option>
                            </select>
                        </div>
                        <div class="mb-1">
                            <label for="name" class="form-label" style="font-size: 1vw;">Name:</label>
                            <input type="text" class="form-control" id="name" aria-describedby="emailHelp"
                                style="height:1.8rem;font-size: 0.8vw;">
                        </div>
                        <div class="mb-1">
                            <label for="slugEdit" style="font-size: 1vw;">Slug:</label>
                            <select class="form-select" id="slugEdit"
                                style="max-width:9rem;height:1.9rem;font-size: 0.8vw;" name="slug">
                                <option>Apple</option>
                                <option>Samsung</option>
                                <option>Oppo</option>
                                <option>Xiaomi</option>
                                <option>Vivo</option>
                                <option>Realme</option>
                                <option>Asus</option>
                                <option>Nokia</option>
                                <option>Masstel</option>
                            </select>
                        </div>
                        <div class="mb-1">
                            <label for="price" class="form-label" style="font-size: 1vw;">Price:</label>
                            <input type="text" class="form-control" id="price" aria-describedby="emailHelp"
                                style="height:1.8rem;font-size: 0.8vw;">
                        </div>
                        <div class="mb-1">
                            <label for="image" class="form-label" style="font-size: 1vw;">Image:</label>
                            <input type="text" class="form-control" id="image" aria-describedby="emailHelp"
                                style="height:1.8rem;font-size: 0.8vw;">
                        </div>
                        <div class="mb-1">
                            <label for="sceenEdit" style="font-size: 1vw;">Sceen:</label>
                            <select class="form-select" id="sceenEdit"
                                style="max-width:5rem;height:1.9rem;font-size: 0.8vw;" name="screen">
                                <option>6.4</option>
                                <option>6.5</option>
                                <option>6.6</option>
                                <option>6.7</option>
                                <option>6.8</option>
                            </select>
                        </div>
                        <div class="mb-1">
                            <label for="chip" class="form-label" style="font-size: 1vw;">Chip:</label>
                            <input type="text" class="form-control" id="chip" aria-describedby="emailHelp"
                                style="height:1.8rem;font-size: 0.8vw;">
                        </div>
                        <div class="mb-1">
                            <label for="ramEdit" style="font-size: 1vw;">Ram:</label>
                            <select class="form-select" id="ramEdit"
                                style="max-width:5rem;height:1.9rem;font-size: 0.8vw;" name="ram">
                                <option>2</option>
                                <option>4</option>
                                <option>8</option>
                                <option>16</option>
                            </select>
                        </div>
                        <div class="mb-1">
                            <label for="romEdit" style="font-size: 1vw;">Rom:</label>
                            <select class="form-select" id="romEdit"
                                style="max-width:5rem;height:1.9rem;font-size: 0.8vw;" name="rom">
                                <option>64</option>
                                <option>128</option>
                                <option>256</option>
                                <option>512</option>
                            </select>
                        </div>
                        <div class="mb-1">
                            <label for="bestSeller" class="form-label" style="font-size: 1vw;">BestSeller:</label>
                            <input type="checkbox" name="bestSeller" id="bestSeller">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
</body>
<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.6.3.js" integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM="
    crossorigin="anonymous"></script>
<!-- bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
    integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
    crossorigin="anonymous"></script>
<script src="/js/admin/home.js"></script>
<!-- sweetalert -->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<!-- code js -->
<script>
    $(document).ready(function () {
        // vaildation form
        let tenSanpham = document.querySelector('input[name="name"]');
        let slug = document.querySelector('select[name="slug"]');
        tenSanpham.addEventListener('keyup', function () {
            let valueTensanpham = tenSanpham.value;
            valueTensanpham = valueTensanpham.toLowerCase();
            let arrayTensanpham = valueTensanpham.split(' ');
            arrayTensanpham.forEach(element => {
                if (element == 'iphone') {
                    slug.value = 'Apple';
                }
                if (element == 'samsung') {
                    slug.value = 'Samsung';
                }
                if (element == 'Oppo') {
                    slug.value = 'oppo';
                }
                if (element == 'xiaomi') {
                    slug.value = 'Xiaomi';
                }
                if (element == 'vivo') {
                    slug.value = 'Vivo';
                }
                if (element == 'realme') {
                    slug.value = 'Realme';
                }
            });
        });

        // search product
        let btnsearch = document.getElementById('btnsearch');
        btnsearch.addEventListener('click', function () {
            let search = document.querySelector('input[name="search"]');
            let valueSearch = search.value;

            $.ajax({
                url: '/admin/search/' + valueSearch,
                type: 'GET',
                data: {
                    search: valueSearch
                },
                success: function (data) {
                    window.location.href = '/admin/search/' + valueSearch;
                }
            });
        });

        // delete product
        let productID;
        let datadelete = document.querySelectorAll('#dataDelete');
        datadelete.forEach(e => {
            e.addEventListener('click', function () {
                let id = e.getAttribute('value');
                productID = id;
            });
        })

        let btnDelete = document.getElementsByClassName('btnDelete');
        btnDelete[0].addEventListener('click', function () {
            $.ajax({
                url: '/admin/product/delete/' + productID,
                type: 'GET',
                data: {
                    id: productID
                },
                success: function (data) {
                    swal("Xóa thành công!", "", "success");     
                    let swalbuttoconfirm = document.getElementsByClassName('swal-button--confirm'); 
                    swalbuttoconfirm[0].addEventListener('click', function () {
                        window.location.href = '/admin/product';
                    });           
                    // setInterval(
                    //     function () { 
                    //         window.location.href = '/admin/product';
                    //      },
                    //     1000
                    // );
                }
            });
        });
    })
</script>

</html>